{% extends "parts/base.html.twig" %}

{% block content %}
  <div class="container">
    <div class="row">
      <div class="s12 col">
        <div class="card-panel grey lighten-4">
          <div class="row">
            <div class="s12 col">
              <h2>
                {{ event.title }},
                {{ event.city }}
              </h2>
            </div>
            {% if event.statut %}
              <div class="m6 s12 col">
                <strong>Statut</strong>
              </div>
              <div class="m6 s12 col">
                <p>{{ event.statut }}</p>
              </div>
            {% endif %}
            {% if event.address %}
              <div class="m6 s12 col">
                <strong>Adresse</strong>
              </div>
              <div class="m6 s12 col">
                <p>{{ event.address }}</p>
              </div>
            {% endif %}
            {% if event.documents %}
              <div class="m6 s12 col">
                <strong>Documents</strong>
              </div>
              <div class="m6 s12 col">
                <ul>
                  {% for document in event.documents %}
                    <li>
                      <a href="{{document.url}}">{{document.filename}}</a>
                    </li>
                  {% endfor %}
                </ul>
              </div>
            {% endif %}
            <div class="m6 s12 col">
              <strong>Dates / Heures</strong>
            </div>
            <div class="m6 s12 col">
              {% if event.start|date("d.m.Y") == event.end|date("d.m.Y") %}
                <p>{{ event.start|date("d.m.Y") }}
                  <br/>
                  {{ event.start|date("H:i") }}
                  -
                  {{ event.end|date("H:i") }}</p>
              {% else %}
                <p>
                  <strong>DÃ©but:</strong>
                  {{ event.start|date("d.m.Y, H:i") }}<br/>
                  <strong>Fin:</strong>
                  {{ event.end|date("d.m.Y, H:i") }}</p>
              {% endif %}
            </div>
            {% if event.informations %}
              <div class="m6 s12 col">
                <strong>Informations</strong>
              </div>
              <div class="m6 s12 col">
                <p>{{ event.informations|nl2br }}</p>
              </div>
            {% endif %}
            {% if event.commentaires %}
              <div class="m6 s12 col">
                <strong>Commentaires internes</strong>
              </div>
              <div class="m6 s12 col">
                <p>{{ event.commentaires|nl2br }}</p>
              </div>
            {% endif %}
          </div>
        </div>
        <br>
        <h3>Effectifs</h3>
        <div class="row">
          <div class="m6 s12 col">
            <div class="card-panel green lighten-4">
              <h3>PrÃ©sent</h3>
              <table class="no-style">
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Trumpet I', abrv: 'tp'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Trumpet II', abrv: 'tp'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Saxophone alto', abrv: 'sax'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Saxophone tenor', abrv: 'sax'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Saxophone barython', abrv: 'sax'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Trombone', abrv: 'tb'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Sousaphone', abrv: 'sousa'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'Percu', abrv: 'perc'} %}
                {% include "parts/event-registre.html.twig" withÂ {registre: 'MC', abrv: 'mc'} %}
              </table>
            </div>
          </div>
          <div class="m6 s12 col">
            <div class="card-panel yellow lighten-2">
              <h3>Attente de rÃ©ponse âš </h3>
              {% for id, musicien in event.nonRepondu %}
                <a href="/musiciens/{{ id }}">
                  <strong>{{musicien}}</strong>
                </a><br/>
              {% endfor %}
            </div>
            <div class="card-panel ruby-red lighten-4">
              <h3>Absents ğŸ˜•</h3>
              {% for id, musicien in event.effectifs['Absents'] %}
                <a href="/musiciens/{{ id }}">
                  <strong>{{ musicien.Nom }}</strong>
                </a><br/>
              {% endfor %}
            </div>
          </div>
        </div>

      </div>
    </div>
    <div class="row">
      <div class="col s12">
        <div class="alert alert-info">
          <h3>Mailing</h3>
          <small>Pour faire un copier/coller</small>
          {% set mails = [] %}
          {% for key, registre in event.effectifs %}
            {% if key != "Absents" %}
              {% for musicien in registre %}
                {% set mails = mails|merge([musicien.Mail]) %}
              {% endfor %}
            {% endif %}
          {% endfor %}

          <textarea class="control-form d-block w-100" onclick="this.select()">{{ mails|join(', ') }}</textarea>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
<!doctype html>
